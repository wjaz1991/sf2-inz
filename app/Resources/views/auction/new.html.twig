{% extends "::base.html.twig" %}

{% block javascripts %}
    {{ parent() }}
    
    {% javascripts 'js/dropzone/*' %}
        <script src="{{ asset_url }}"></script>
    {% endjavascripts %}
    
    <script>
    $(function() {
        var imagesCount = '{{ form.images|length }}';
        
        $("#image-add").on('click', function() {
            var imageList = $("#images-list");
            
            var newWidget = imageList.attr('data-prototype');
            
            newWidget = newWidget.replace(/__name__/g, imagesCount);
            imagesCount++;
            var newEl = $('<p></p>').html(newWidget);
            imageList.append(newEl);
        });
    });
    </script>
{% endblock %}

{% block body %}
    <div class="col-md-8 col-md-offset-2">
        <h1 class="text-center">Add new offer</h1>
        <form action="{{ path('auction_new') }}" novalidate action="" method="post" {{ form_enctype(form) }}>
            <h3>Provide auction details</h3>
            {{ form_row(form.title) }}
            {{ form_row(form.description) }}
            {{ form_row(form.price) }}
            {{ form_row(form.category) }}
            {{ form_row(form.private) }}
            {{ form_row(form.startDate) }}
            {{ form_row(form.endDate) }}
            <div id="images-list" data-prototype="{{ form_widget(form.images.vars.prototype)|e }}">
            {% for image in form.images %}
                {{ form_widget(image) }}
                {{ form_errors(image) }}
            {% endfor %}
            </div>
            {{ form_errors(form) }}
            <button type="button" class="btn btn-success" id="image-add">Add image</button><br><br>
            
            <h3>Provide auction address</h3>
            {{ form_widget(form.address) }}
            {{ form_rest(form) }}
            <button type="submit" class="btn btn-default">Add auction</button>
        </form>
    </div>
        
        
{% endblock %}

